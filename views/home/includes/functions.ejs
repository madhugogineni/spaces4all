<script>
    function calculateStampDuty() {
        var propertyValue = $('input[name=stampduty_property_value]').val(), stampdutyId = $('select[name=stamp_duty_id]').val();
        console.log(stampdutyId);
        if (propertyValue != "" && stampdutyId != "") {
            $.ajax({
                type: "GET",
                url: "<%= api_url%>calculate_stamp_duty",
                data: {
                    id: stampdutyId,
                    propertyValue: propertyValue
                },
                success: function (response) {
                    console.log(response);
                    $("input[name=stamp_duty").val(response);
                }
            });
        }
    }
    function calculateEmi(amount, interest, tenure) {
        var intr = interest / 1200;
        var principle = amount;
        var emi = Math.ceil(amount * intr / (1 - (Math.pow(1 / (1 + intr), tenure))));
        var total_interest = Math.ceil((amount * intr / (1 - (Math.pow(1 / (1 + intr), tenure)))) * tenure) - amount;
        var total_amount = amount + total_interest;
        var response = '<div class="padding-as25 margin-30"><div>';
        response += '<div class="row"><h5>Your Monthly EMI is</h5><b><span class="">Rs. ' + emi + ' /-</span></b></div><hr>';
        response += '<div class="row"><h5>Total Amount Payable</h5><b><span class="">Rs. ' + total_amount + ' /-</span></b></div><hr>';
        response += '<div class="row"><h5>Total Principle Amount Payable</h5><b><span class="">Rs. ' + principle + ' /-</span></b></div><hr>';
        response += '<div class="row"><h5>Total Intrest Amount Payable</h5><b><span class="">Rs. ' + total_interest + ' /-</span></b></div></div></div>';
        $('#emi_value').html(response);
    }
    function loadEligibilityCheck(loanAmount, netIncome, tenure, interest) {
        // console.log(loanAmount, netIncome, tenure, interest);
        var intr = interest / 1200;
        var amount = netIncome * 60;
        var maxLoan = netIncome * 60;
        var loanEmi = Math.ceil(loanAmount * intr / (1 - (Math.pow(1 / (1 + intr), tenure))));
        maxEmi = Math.ceil(amount * intr / (1 - (Math.pow(1 / (1 + intr), tenure))));
        if (loanAmount <= amount) {
            var response = '<h5><i class="fa fa-check"></i> You are Eligible for this loan</h5><b style="font-size: 18px">Rs.' + loanAmount + ' at EMI Rs. ' + loanEmi + ' </b><br><br><hr>';
            response += '<p style="font-size: 15px">You are Eligible for a maximum loan of </p><b><span class="">Rs. ' + maxLoan + ' at EMI Rs.' + maxEmi + '</span></b>';
        } else {
            var response = '<h5><i class="fa fa-check"></i>Sorry You are Not Eligible for this loan</h5><b style="font-size: 18px">Rs.' + loanAmount + ' at EMI Rs. ' + loanEmi + ' </b><br><br><hr>';
            response += '<p style="font-size: 15px">You are Eligible for a maximum loan of </p><b><span class="">Rs. ' + maxLoan + ' at EMI Rs.' + maxEmi + '</span></b>';
        }
        response += '<br/><br/><br/><br/>';
        response += '<a href = "<%= base_url %>home/apply_home_loan" class="btn btn-primary btn-lg" > Apply For a Loan</a>';
        $('#loan_eligibility_response').html(response);
    }
    function setUpHomeSlider() {
        $.ajax({
            method: "GET",
            url: "<%=api_url %>get_home_slider",
            success: function (response) {
                var result = '';
                for (var i = 0; i < response.length; i++) {
                    var slide = response[i];
                    result += '<li class="parallax" style="background-image:url(uploads/home-slide/' + slide.image + ');">';
                    result += '<a href="' + slide.url + '" class="btn" style="width: 100%; height: 100%;"> </a></li>';
                }
                $("#slides").html(result);
            }

        });
    }
    function setUpCities(divId, cityId) {
        $.ajax({
            method: "GET",
            url: "<%= api_url %>get_cities",
            success: function (response) {
                var result = '<option value="">---CITY---</option>';
                for (var i = 0; i < response.length; i++) {
                    var row = response[i];
                    if (cityId != "" && cityId != undefined) {
                        if (cityId == row.city_id) {
                            result += '<option value="' + row.city_id + '" selected >' + row.city + '</option>';
                        } else {
                            result += '<option value="' + row.city_id + '">' + row.city + '</option>';
                        }
                    } else {
                        result += '<option value="' + row.city_id + '">' + row.city + '</option>';
                    }
                }
                $(divId).html(result);
            }
        });
    }
    function setUpProjectTypes() {
        $.ajax({
            method: "GET",
            url: "<%= api_url %>get_project_types",
            success: function (response) {
                var result = '<option value="">Type</option>';
                for (var i = 0; i < response.length; i++) {
                    var row = response[i];
                    result += '<option value="' + row.project_type_id + '">' + row.type + '</option>'
                }
                $("#project_type").append(result);
            }
        });
    }
    function showLocality(cityId,divId) {
        $.ajax({
            method: "GET",
            url: "<%= api_url %>get_localities",
            data: {
                city_id: cityId
            },
            success: function (response) {
                var result = '';
                result += '<option value="">Locality</option>';
                for (var i = 0; i < response.length; i++) {
                    var row = response[i];
                    result += '<option value="' + row.locality_id + '">' + row.locality + '</option>'
                }

                $(divId).find('option').remove().end();
                $(divId).append(result);
            }
        });
    }
    function send_Property_Callback() {
        console.log($("#call_project").val());
        var filter = /^[0-9-+]+$/;

        var name = $("#call_name").val();

        var phone = $("#call_phone").val();

        var property_id = $("#call_project").val();

        // var dataString = 'name=' + name + '&phone=' + phone + '&property_id=' + property_id;

        if ($("#call_name1").val() == "") {

            $("#call_name1").focus();

            $("#errorBox3").html("<div class='alert alert-error fade in'> <a href='#' data-dismiss='alert' class='close'>x</a> <strong>Please Enter Name</strong></div>");

        } else if ($("#call_phone1").val() == "") {

            $("#call_phone1").focus();

            $("#errorBox3").html("<div class='alert alert-error fade in'> <a href='#' data-dismiss='alert' class='close'>x</a> <strong>Please Enter Valid 10 Digit Phone Number</strong></div>");

        } else if (phone.length != "10") {

            $("#call_phone1").focus();

            $("#errorBox3").html("<div class='alert alert-error fade in'> <a href='#' data-dismiss='alert' class='close'>x</a> <strong>Please Enter Valid 10 Digit Phone Number</strong></div>");

        } else if (!filter.test(phone)) {

            $("#call_phone1").focus();

            $("#errorBox3").html("<div class='alert alert-error fade in'> <a href='#' data-dismiss='alert' class='close'>x</a> <strong>Please Enter Valid 10 Digit Phone Number</strong></div>");

        } else {

            $.ajax({
                type: "GET",
                url: "<%= api_url %>add_property_call_back",
                // data: dataString,
                data: {
                    name: name,
                    phone: phone,
                    property_id: property_id
                },
                success: function (response) {
                    $('#call_back_response').html(response);
                }
            });
        }
    }
    function setUpEminities(divId) {
        $.ajax({
            type: 'GET',
            url: "<%=api_url %>get_emenities",
            success: function (response) {
                var result = "";
                for (var i = 0; i < response.length; i++) {
                    result += "<div class='col-md-3'><label><input type='checkbox' name='amenities1[]' value=" + response[i].amenity_id + "></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + response[i].amenity + "</div>";
                }
                $(divId).html(result);
            }
        });
    }
    function setUpPropertyTypes(divId) {
        $.ajax({
            type: 'GET',
            url: "<%=api_url %>get_property_types",
            success: function (response) {
                var result = '<option value="">---SELECT---</option>';
                for (var i = 0; i < response.length; i++) {
                    result += '<option value="' + response[i].property_type_id + '">' + response[i].type + '</option>';
                }
                $(divId).html(result);
            }
        });
    }
    function setUpStates(divId) {
        $.ajax({
            method: 'GET',
            url: '<%= api_url %>get_states',
            success: function (response) {
                var result = '<option value="">---SELECT---</option>';
                for(var i =0;i< response.length;i++) {
                    result += '<option value="'+response[i].state_id+'">'+response[i].state_name+'</option>'
                }
                $(divId).html(result);
            }
        });
    }
    
</script>